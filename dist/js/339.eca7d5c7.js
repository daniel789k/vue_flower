(self["webpackChunkvue_flower"]=self["webpackChunkvue_flower"]||[]).push([[339],{653:function(t,e,s){
/*!
  * Bootstrap toast.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
(function(e,a){t.exports=a(s(9011),s(7956),s(8248),s(4035))})(0,(function(t,e,s,a){"use strict";const o="toast",n="bs.toast",i=`.${n}`,l=`mouseover${i}`,u=`mouseout${i}`,c=`focusin${i}`,r=`focusout${i}`,d=`hide${i}`,h=`hidden${i}`,p=`show${i}`,g=`shown${i}`,m="fade",b="hide",v="show",k="showing",f={animation:"boolean",autohide:"boolean",delay:"number"},y={animation:!0,autohide:!0,delay:5e3};class _ extends t{constructor(t,e){super(t,e),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return y}static get DefaultType(){return f}static get NAME(){return o}show(){const t=e.trigger(this._element,p);if(t.defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(m);const s=()=>{this._element.classList.remove(k),e.trigger(this._element,g),this._maybeScheduleHide()};this._element.classList.remove(b),a.reflow(this._element),this._element.classList.add(v,k),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown())return;const t=e.trigger(this._element,d);if(t.defaultPrevented)return;const s=()=>{this._element.classList.add(b),this._element.classList.remove(k,v),e.trigger(this._element,h)};this._element.classList.add(k),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(v),super.dispose()}isShown(){return this._element.classList.contains(v)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout((()=>{this.hide()}),this._config.delay)))}_onInteraction(t,e){switch(t.type){case"mouseover":case"mouseout":this._hasMouseInteraction=e;break;case"focusin":case"focusout":this._hasKeyboardInteraction=e;break}if(e)return void this._clearTimeout();const s=t.relatedTarget;this._element===s||this._element.contains(s)||this._maybeScheduleHide()}_setListeners(){e.on(this._element,l,(t=>this._onInteraction(t,!0))),e.on(this._element,u,(t=>this._onInteraction(t,!1))),e.on(this._element,c,(t=>this._onInteraction(t,!0))),e.on(this._element,r,(t=>this._onInteraction(t,!1)))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each((function(){const e=_.getOrCreateInstance(this,t);if("string"===typeof t){if("undefined"===typeof e[t])throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}return s.enableDismissTrigger(_),a.defineJQueryPlugin(_),_}))},5368:function(t,e,s){"use strict";s.d(e,{A:function(){return o}});var a=s(7483);function o(t,e="更新"){if(t.data.success)a.A.emit("push-message",{style:"success",title:`${e}成功`});else{const s="string"===typeof t.data.message?[t.data.message]:t.data.message;a.A.emit("push-message",{style:"danger",title:`${e}失敗`,content:s.join(",")})}}},7649:function(t,e,s){"use strict";s.d(e,{J:function(){return o}});var a=s(5615);const o=(0,a.nY)("buyCount",{state:()=>({buyCount:0}),getters:{getbuyCount:({buyCount:t})=>t},actions:{setbuyCount(t){this.buyCount=t}}})},2509:function(t,e,s){"use strict";s.d(e,{A:function(){return d}});var a=s(641);const o={class:"footer bg-subColor2 py-4"},n=(0,a.Lk)("p",{class:"text-subColor3 text-center mb-0"},"Copyright © 2021 花之藝.All rights reserved.",-1),i=[n];function l(t,e){return(0,a.uX)(),(0,a.CE)("footer",o,i)}var u=s(6262);const c={},r=(0,u.A)(c,[["render",l]]);var d=r},1748:function(t,e,s){"use strict";s.d(e,{A:function(){return _}});var a=s(641);const o={class:"toast-container position-absolute pe-3 top-0 end-0"};function n(t,e,s,n,i,l){const u=(0,a.g2)("Toast");return(0,a.uX)(),(0,a.CE)("div",o,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.messages,((t,e)=>((0,a.uX)(),(0,a.Wv)(u,{key:e,msg:t},null,8,["msg"])))),128))])}s(4114);var i=s(33);const l={class:"toast",role:"alert","aria-live":"assertive","aria-atomic":"true",ref:"toast"},u={class:"toast-header"},c={class:"me-auto"},r=(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"toast","aria-label":"Close"},null,-1),d={key:0,class:"toast-body"};function h(t,e,s,o,n,h){return(0,a.uX)(),(0,a.CE)("div",l,[(0,a.Lk)("div",u,[(0,a.Lk)("span",{class:(0,i.C4)([`bg-${s.msg.style}`,"p-2 rounded me-2 d-inline-block"])},null,2),(0,a.Lk)("strong",c,(0,i.v_)(s.msg.title),1),r]),s.msg.content?((0,a.uX)(),(0,a.CE)("div",d,(0,i.v_)(s.msg.content),1)):(0,a.Q3)("",!0)],512)}var p=s(653),g=s.n(p),m={props:["msg"],mounted(){const t=this.$refs.toast,e=new(g())(t,{delay:6e3});e.show()}},b=s(6262);const v=(0,b.A)(m,[["render",h]]);var k=v,f={components:{Toast:k},data(){return{messages:[]}},inject:["emitter"],mounted(){this.emitter.on("push-message",(t=>{const{style:e="success",title:s,content:a}=t;this.messages.push({style:e,title:s,content:a})}))}};const y=(0,b.A)(f,[["render",n]]);var _=y},8339:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return _t}});var a=s(641);const o={class:"bg-pageBack"};function n(t,e,s,n,i,l){const u=(0,a.g2)("NavBar"),c=(0,a.g2)("ToastMessages"),r=(0,a.g2)("router-view"),d=(0,a.g2)("FooTer");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(u),(0,a.Lk)("div",o,[(0,a.bF)(c),(0,a.bF)(r)]),(0,a.bF)(d)],64)}s(4114);var i=s(3751),l=s(33),u=s(3420);const c={class:"navbar navbar-expand-lg navbar-light sticky-top bg-navBack"},r={class:"container"},d=(0,a.Lk)("a",{class:"navbar-brand",href:"#"},[(0,a.Lk)("img",{src:u,alt:"logo",width:"30",height:"30"}),(0,a.eW)(" 花之藝 ")],-1),h=(0,a.Lk)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,a.Lk)("span",{class:"navbar-toggler-icon"})],-1),p={class:"collapse navbar-collapse",id:"navbarSupportedContent"},g={class:"navbar-nav ms-auto"},m=(0,a.Lk)("i",{class:"bi bi-flower2 me-1"},null,-1),b=(0,a.Lk)("i",{class:"bi bi-flower2 me-1"},null,-1),v={class:"text-start mb-0 position-relative d-inline me-0","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent"},k=(0,a.Lk)("i",{class:"bi bi-cart2 me-1"},null,-1),f={class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"},y=(0,a.Lk)("span",{class:"visually-hidden"},"buycount",-1),_={class:"text-start mb-0 position-relative"},L=(0,a.Lk)("i",{class:"bi bi-cart2 me-1"},null,-1),C={key:0,class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"},w=(0,a.Lk)("span",{class:"visually-hidden"},"buycount",-1),$=(0,a.Lk)("i",{class:"bi bi-heart me-1"},null,-1),x=(0,a.Lk)("i",{class:"bi bi-heart me-1"},null,-1),W=(0,a.Lk)("i",{class:"bi bi-person me-1"},null,-1),E=(0,a.Lk)("i",{class:"bi bi-person me-1"},null,-1),X=(0,a.Lk)("i",{class:"bi bi-person"},null,-1),S={class:"offcanvas offcanvas-end cartbg",tabindex:"-1",id:"offcanvasExample","aria-labelledby":"offcanvasExampleLabel"},A=(0,a.Lk)("div",{class:"offcanvas-header"},[(0,a.Lk)("h5",{class:"offcanvas-title",id:"offcanvasExampleLabel"},"購物車"),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),I={key:0,class:"offcanvas-body pt-0"},Q={class:"table align-middle"},T=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th"),(0,a.Lk)("th",{style:{width:"120px"}}),(0,a.Lk)("th",{style:{width:"120px"}},"品名"),(0,a.Lk)("th",{style:{width:"120px"}},"數量"),(0,a.Lk)("th",null,"單價")])],-1),F={key:0},M=["disabled","onClick"],q=(0,a.Lk)("i",{class:"bi bi-x"},null,-1),K=[q],D=["src"],J={key:0,class:"text-success"},U={class:"input-group input-group-sm"},j=["disabled","onChange","onUpdate:modelValue"],B={class:"input-group-text"},H={class:"text-end"},N={key:0,class:"text-success"},V=(0,a.Lk)("td",null,null,-1),P=(0,a.Lk)("td",{colspan:"3",class:"text-end"},"總計",-1),z={class:"text-end"},O={key:0},Y=(0,a.Lk)("td",null,null,-1),G=(0,a.Lk)("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),R={class:"text-end text-success"},Z={key:0,class:"input-group mb-3 input-group-sm w-75 ms-lg-auto"},tt={class:"input-group-append"},et={key:1,class:"input-group mb-3 input-group-sm"},st={class:"input-group-append"},at={class:"text-end"},ot=(0,a.Lk)("button",{type:"button",class:"btn btn-pageBack","aria-label":"Close","data-bs-dismiss":"offcanvas"},"前往結帳",-1),nt={key:1,class:"offcanvas-body pt-0"},it=(0,a.Lk)("h2",{class:"mb-4"},"尚無商品",-1),lt=(0,a.Lk)("i",{class:"bi bi-flower2 me-1"},null,-1);function ut(t,e,s,o,n,u){const q=(0,a.g2)("UserLoading"),ut=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(q,{active:n.isLoading},null,8,["active"]),(0,a.Lk)("nav",c,[(0,a.Lk)("div",r,[d,h,(0,a.Lk)("div",p,[(0,a.Lk)("div",g,[n.windowWidth<992?((0,a.uX)(),(0,a.Wv)(ut,{key:0,to:"/products",class:"nav-link",onClick:e[0]||(e[0]=t=>this.$router.push("/products")),"data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent"},{default:(0,a.k6)((()=>[m,(0,a.eW)("花藝商品")])),_:1})):(0,a.Q3)("",!0),n.windowWidth>=992?((0,a.uX)(),(0,a.Wv)(ut,{key:1,to:"/products",class:"nav-link"},{default:(0,a.k6)((()=>[b,(0,a.eW)("花藝商品")])),_:1})):(0,a.Q3)("",!0),n.windowWidth<992?((0,a.uX)(),(0,a.CE)("button",{key:2,type:"button",class:"nav-link me-1 text-start","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasExample","aria-controls":"offcanvasExample",onClick:e[1]||(e[1]=(0,i.D$)((t=>(u.getCart(),u.addCouponCode())),["prevent"]))},[(0,a.Lk)("p",v,[k,(0,a.eW)("購物車"),(0,a.Lk)("span",f,[(0,a.eW)((0,l.v_)(t.getbuyCount)+" ",1),y])])])):(0,a.Q3)("",!0),n.windowWidth>=992?((0,a.uX)(),(0,a.CE)("button",{key:3,type:"button",class:"nav-link me-1","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasExample","aria-controls":"offcanvasExample",onClick:e[2]||(e[2]=(0,i.D$)((t=>(u.getCart(),u.addCouponCode())),["prevent"]))},[(0,a.Lk)("p",_,[L,(0,a.eW)("購物車"),t.getbuyCount>0?((0,a.uX)(),(0,a.CE)("span",C,[(0,a.eW)((0,l.v_)(t.getbuyCount)+" ",1),w])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0),n.windowWidth<992?((0,a.uX)(),(0,a.Wv)(ut,{key:4,to:"/loves",class:"nav-link",onClick:e[3]||(e[3]=t=>this.$router.push("/loves")),"data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent"},{default:(0,a.k6)((()=>[$,(0,a.eW)("我的最愛")])),_:1})):(0,a.Q3)("",!0),n.windowWidth>=992?((0,a.uX)(),(0,a.Wv)(ut,{key:5,to:"/loves",class:"nav-link"},{default:(0,a.k6)((()=>[x,(0,a.eW)("我的最愛")])),_:1})):(0,a.Q3)("",!0),0===n.loginStatus&n.windowWidth<992?((0,a.uX)(),(0,a.Wv)(ut,{key:6,to:"/user/login",class:"nav-link",onClick:e[4]||(e[4]=t=>this.$router.push("/user/login")),"data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent"},{default:(0,a.k6)((()=>[W,(0,a.eW)("會員登入")])),_:1})):(0,a.Q3)("",!0),0===n.loginStatus&n.windowWidth>=992?((0,a.uX)(),(0,a.Wv)(ut,{key:7,to:"/user/login",class:"nav-link"},{default:(0,a.k6)((()=>[E,(0,a.eW)("會員登入")])),_:1})):(0,a.Q3)("",!0),0!==n.loginStatus?((0,a.uX)(),(0,a.Wv)(ut,{key:8,onClick:(0,i.D$)(u.logout,["prevent"]),to:"/",class:"nav-link"},{default:(0,a.k6)((()=>[X,(0,a.eW)("會員您好")])),_:1},8,["onClick"])):(0,a.Q3)("",!0),0!==n.loginStatus?((0,a.uX)(),(0,a.Wv)(ut,{key:9,to:"/orders",class:"nav-link"},{default:(0,a.k6)((()=>[(0,a.eW)("訂單查詢")])),_:1})):(0,a.Q3)("",!0)])])])]),(0,a.Lk)("div",S,[A,0!==t.getbuyCount?((0,a.uX)(),(0,a.CE)("div",I,[(0,a.Lk)("table",Q,[T,n.cart.carts?((0,a.uX)(),(0,a.CE)("tbody",F,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.cart.carts,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id},[(0,a.Lk)("td",null,[(0,a.Lk)("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:n.status.loadingItem===e.id,onClick:t=>u.removeCartItem(e.id)},K,8,M)]),(0,a.Lk)("td",null,[(0,a.Lk)("img",{src:e.product.imageUrl,alt:"",class:"img-fluid"},null,8,D)]),(0,a.Lk)("td",null,[(0,a.eW)((0,l.v_)(e.product.title)+" ",1),e.coupon?((0,a.uX)(),(0,a.CE)("div",J," 已套用優惠券 ")):(0,a.Q3)("",!0)]),(0,a.Lk)("td",null,[(0,a.Lk)("div",U,[(0,a.bo)((0,a.Lk)("input",{type:"number",class:"form-control",min:"1",disabled:e.id===n.status.loadingItem,onChange:t=>u.updateCart(e),"onUpdate:modelValue":t=>e.qty=t},null,40,j),[[i.Jo,e.qty,void 0,{number:!0}]]),(0,a.Lk)("div",B,"/ "+(0,l.v_)(e.product.unit),1)])]),(0,a.Lk)("td",H,[n.cart.final_total!==n.cart.total?((0,a.uX)(),(0,a.CE)("small",N,"折扣價：")):(0,a.Q3)("",!0),(0,a.eW)(" "+(0,l.v_)(t.$filters.currency(e.final_total)),1)])])))),128))])):(0,a.Q3)("",!0),(0,a.Lk)("tfoot",null,[(0,a.Lk)("tr",null,[V,P,(0,a.Lk)("td",z,(0,l.v_)(t.$filters.currency(n.cart.total)),1)]),n.cart.final_total!==n.cart.total?((0,a.uX)(),(0,a.CE)("tr",O,[Y,G,(0,a.Lk)("td",R,(0,l.v_)(t.$filters.currency(n.cart.final_total)),1)])):(0,a.Q3)("",!0)])]),n.windowWidth>992?((0,a.uX)(),(0,a.CE)("div",Z,[(0,a.bo)((0,a.Lk)("input",{type:"text pe-auto",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=t=>n.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[i.Jo,n.coupon_code]]),(0,a.Lk)("div",tt,[(0,a.Lk)("button",{class:"btn btn-outline-secondary rounded-0 rounded-end",type:"button",onClick:e[6]||(e[6]=(...t)=>u.addCouponCode&&u.addCouponCode(...t))}," 套用優惠碼 ")])])):((0,a.uX)(),(0,a.CE)("div",et,[(0,a.bo)((0,a.Lk)("input",{type:"text pe-auto",class:"form-control","onUpdate:modelValue":e[7]||(e[7]=t=>n.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[i.Jo,n.coupon_code]]),(0,a.Lk)("div",st,[(0,a.Lk)("button",{class:"btn btn-outline-secondary rounded-0 rounded-end",type:"button",onClick:e[8]||(e[8]=(...t)=>u.addCouponCode&&u.addCouponCode(...t))}," 套用優惠碼 ")])])),(0,a.Lk)("div",at,[(0,a.bF)(ut,{to:"/checkform"},{default:(0,a.k6)((()=>[ot])),_:1})])])):(0,a.Q3)("",!0),0==t.getbuyCount?((0,a.uX)(),(0,a.CE)("div",nt,[it,(0,a.bF)(ut,{to:"/products",onClick:e[9]||(e[9]=t=>this.$router.push("/products")),class:"nav-link ps-3 fs-5","data-bs-dismiss":"offcanvas","aria-label":"Close"},{default:(0,a.k6)((()=>[lt,(0,a.eW)("前往選購")])),_:1})])):(0,a.Q3)("",!0)])],64)}var ct=s(7483),rt=s(7649),dt=s(5615),ht={data(){return{status:{loadingItem:""},cart:{},coupon_code:"",nowuse_coupon_code:"",loginStatus:0,isLoading:!1,loveFlower:[],buyCount:0,windowWidth:window.innerWidth}},inject:["emitter"],methods:{$httpMessageState(t,e="更新"){if(t.data.success)ct.A.emit("push-message",{style:"success",title:`${e}成功`});else{const s="string"===typeof t.data.message?[t.data.message]:t.data.message;ct.A.emit("push-message",{style:"danger",title:`${e}失敗`,content:s.join(",")})}},logout(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/logout";this.$http.post(t,this.user).then((t=>{t.data.success&&(this.isLoading=!1,this.loginStatus=0,this.$httpMessageState(t,"登出"),this.$router.push("/"))})).catch((t=>{t.data.success||(this.isLoading=!1,this.loginStatus=0,ct.A.emit("push-message",{style:"danger",title:"登出失敗"}),this.$router.push("/"))}))},getCart(){const t="https://vue3-course-api.hexschool.io/api/vue-final-flower/cart";this.isLoading=!0,this.$http.get(t).then((t=>{this.cart=t.data.data,0===this.cart.carts.length&&this.setbuyCount(0),0!==this.cart.carts.length&&(this.setbuyCount(this.cart.carts.map((t=>t.qty)).reduce(((t,e)=>t+e))),""===this.coupon_code&&"coupon"in this.cart.carts[0]&&(this.coupon_code=this.cart.carts[0].coupon.code)),this.isLoading=!1})).catch((t=>{t.data.success||ct.A.emit("push-message",{style:"danger",title:"取得購物車失敗"})}))},updateCart(t){const e=`https://vue3-course-api.hexschool.io/api/vue-final-flower/cart/${t.id}`;this.isLoading=!0,this.status.loadingItem=t.id;const s={product_id:t.product_id,qty:t.qty};this.$http.put(e,{data:s}).then((t=>{this.status.loadingItem="",this.getCart()})).catch((t=>{t.data.success||ct.A.emit("push-message",{style:"danger",title:"更新購物車失敗"})}))},addCouponCode(){const t="https://vue3-course-api.hexschool.io/api/vue-final-flower/coupon";let e={};""!==this.coupon_code?this.nowuse_coupon_code=this.coupon_code:this.coupon_code=this.nowuse_coupon_code,0===this.cart.carts.length&&(this.coupon_code="",this.nowuse_coupon_code=""),e={code:this.coupon_code},this.isLoading=!0,this.$http.post(t,{data:e}).then((t=>{this.coupon_code&&(this.$httpMessageState(t,"加入優惠券"),this.getCart(),this.isLoading=!1)})).catch((t=>{t.data.success||ct.A.emit("push-message",{style:"danger",title:"優惠券添加失敗"})}))},removeCartItem(t){this.status.loadingItem=t;const e=`https://vue3-course-api.hexschool.io/api/vue-final-flower/cart/${t}`;this.isLoading=!0,this.$http.delete(e).then((t=>{this.$httpMessageState(t,"移除購物車品項"),this.status.loadingItem="",this.getCart(),this.isLoading=!1})).catch((t=>{t.data.success||ct.A.emit("push-message",{style:"danger",title:"移除品項失敗"})}))},comfirmLogin(){const t=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=t;const e="https://vue3-course-api.hexschool.io/api/user/check";this.$http.post(e,this.user).then((t=>{t.data.success?this.loginStatus=1:this.loginStatus=0})).catch((t=>{t.data.success||ct.A.emit("push-message",{style:"danger",title:"登入認證失敗"})}))}},mounted(){window.addEventListener("resize",(()=>{this.windowWidth=window.innerWidth}))},computed:{...(0,dt.aH)(rt.J,["getbuyCount","setbuyCount"])},created(){this.getCart()},updated(){this.comfirmLogin()}},pt=s(6262);const gt=(0,pt.A)(ht,[["render",ut]]);var mt=gt,bt=s(2509),vt=s(1748),kt=s(5368),ft={provide(){return{emitter:ct.A,$httpMessageState:kt.A}},components:{NavBar:mt,FooTer:bt.A,ToastMessages:vt.A}};const yt=(0,pt.A)(ft,[["render",n]]);var _t=yt},3420:function(t,e,s){"use strict";t.exports=s.p+"img/flowerart-favicon-color.ece37f41.svg"}}]);
//# sourceMappingURL=339.eca7d5c7.js.map